(this["webpackJsonpsgn-explorer"]=this["webpackJsonpsgn-explorer"]||[]).push([[11],{1132:function(e,t,a){"use strict";a.r(t);var r=a(39),n=a(1),i=a.n(n),s=a(0),c=a.n(s),o=a(69),d=a.n(o),l=a(89),u=a(913),w=a(76),h=a(1131),m=a(1136),v=a(1127),p=a(1128),g=a(1012),R=a(956),S=a.n(R),E=a(926);class f extends i.a.Component{constructor(e,t){super(e),this.intendWithdraw=()=>{this.gateway.post("/validator/withdrawReward",{eth_addr:this.currentUser}).then(()=>{u.a.success("Success! Please wait a few seconds to trigger redeem."),this.waitSigs()}).catch(e=>{console.error(e)})},this.waitSigs=()=>{this.setState({action:"wait",waitTime:30}),this.interval=setInterval(()=>{var e=this.state.waitTime;if(0===e)return this.setState({action:"redeem"}),void clearInterval(this.interval);this.setState({waitTime:e-1})},1e3)},this.redeemReward=()=>{this.gateway.get("/validator/rewardRequest/".concat(this.currentUser)).then(e=>{var t=e.data.result,a=this.props,r=a.DPoS,n=a.SGN,i=r.redeemedMiningReward,s=n.redeemedServiceReward;t.mining_reward!==d.a.values(i)[0].value||t.service_reward!==d.a.values(s)[0].value?this.contracts.SGN.methods.redeemReward.cacheSend("0x"+t.reward_request_proto_bytes):u.a.warn("You do not have more reward to redeem.")}).catch(e=>{console.error(e)})},this.renderActions=()=>{var e=this.state,t=e.action,a=e.waitTime;switch(t){case"init":return[i.a.createElement(w.a,{type:"primary",onClick:this.intendWithdraw},"Initialize Redeem")];case"wait":return[i.a.createElement(w.a,{disabled:!0},"Collecting signatures. ",a," seconds left")];case"redeem":return[i.a.createElement(w.a,{type:"primary",onClick:this.redeemReward},"Redeem Reward")]}};var a=e.accounts,r=e.network.setting;this.currentUser=a[0],this.contracts=t.drizzle.contracts,this.state={action:"init"},this.contracts.SGN.methods.redeemedServiceReward.cacheCall(this.currentUser),this.contracts.DPoS.methods.redeemedMiningReward.cacheCall(this.currentUser),this.gateway=S.a.create({baseURL:r.gateway,timeout:1e3}),this.gateway.get("/validator/reward/".concat(this.currentUser)).then(e=>{var t=e.data.result;this.setState({miningReward:t.mining_reward,serviceReward:t.service_reward})}).catch(e=>{console.error(e),e.response?u.a.error(e.response.data.error):u.a.warning("Please config gateway url in setting to load sgn reward correctly")})}render(){var e=this.props,t=e.DPoS,a=e.SGN,r=this.state,n=r.miningReward,s=r.serviceReward,c=t.redeemedMiningReward,o=a.redeemedServiceReward;return d.a.isEmpty(o)||d.a.isEmpty(c)?i.a.createElement(h.a,null):i.a.createElement(m.a,{title:"Reward",actions:this.renderActions()},i.a.createElement(v.a,{style:{marginTop:"10px"}},i.a.createElement(p.a,{span:12},i.a.createElement(g.a,{title:"Cumulative Mining Reward",value:Object(E.a)(n,!0)})),i.a.createElement(p.a,{span:12},i.a.createElement(g.a,{title:"Cumulative Service Reward",value:Object(E.a)(s,!0)})),i.a.createElement(p.a,{span:12},i.a.createElement(g.a,{title:"Redeemed Mining Reward",value:Object(E.a)(d.a.values(c)[0].value,!0)})),i.a.createElement(p.a,{span:12},i.a.createElement(g.a,{title:"Redeemed Service Reward",value:Object(E.a)(d.a.values(o)[0].value,!0)}))))}}f.contextTypes={drizzle:c.a.object},t.default=Object(l.drizzleConnect)(f,(function(e){var t=e.network,a=e.accounts,n=e.contracts,i=e.DPoS,s=e.SGN;return{network:t,accounts:a,DPoS:Object(r.a)(Object(r.a)({},i),n.DPoS),SGN:Object(r.a)(Object(r.a)({},s),n.SGN)}}))},926:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a(69);var r=a(920),n=a.n(r),i=(a(159),(e,t)=>((e,t,a)=>{if(e)return a?"".concat(n.a.utils.fromWei(e)," ").concat(t):"".concat(n.a.utils.fromWei(e).split(".")[0]," ").concat(t)})(e,"CELR",t))},958:function(e,t){},959:function(e,t){},961:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=961}}]);
//# sourceMappingURL=11.dfba34be.chunk.js.map