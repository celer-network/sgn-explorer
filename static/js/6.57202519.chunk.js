(this["webpackJsonpsgn-explorer"]=this["webpackJsonpsgn-explorer"]||[]).push([[6],{1035:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return n}));var r=["Unbonded","Bonded","Unbonding"],s=["ProposalDeposit","GovernVoteTimeout","SlashTimeout","MinValidatorNum","MaxValidatorNum","MinStakeInPool","AdvanceNoticePeriod"],i={Voting:"1",Closed:"2"},n={Yes:1,No:2,Abstain:3}},1117:function(e,t,a){"use strict";for(var r="qpzry9x8gf2tvdw0s3jn54khce6mua7l",s={},i=0;i<r.length;i++){var n=r.charAt(i);if(void 0!==s[n])throw new TypeError(n+" is ambiguous");s[n]=i}function o(e){var t=e>>25;return(33554431&e)<<5^996825010&-(t>>0&1)^642813549&-(t>>1&1)^513874426&-(t>>2&1)^1027748829&-(t>>3&1)^705979059&-(t>>4&1)}function c(e){for(var t=1,a=0;a<e.length;++a){var r=e.charCodeAt(a);if(r<33||r>126)return"Invalid prefix ("+e+")";t=o(t)^r>>5}for(t=o(t),a=0;a<e.length;++a){var s=e.charCodeAt(a);t=o(t)^31&s}return t}function d(e,t){if(t=t||90,e.length<8)return e+" too short";if(e.length>t)return"Exceeds length limit";var a=e.toLowerCase(),r=e.toUpperCase();if(e!==a&&e!==r)return"Mixed-case string "+e;var i=(e=a).lastIndexOf("1");if(-1===i)return"No separator character for "+e;if(0===i)return"Missing prefix for "+e;var n=e.slice(0,i),d=e.slice(i+1);if(d.length<6)return"Data too short";var l=c(n);if("string"===typeof l)return l;for(var h=[],u=0;u<d.length;++u){var m=d.charAt(u),j=s[m];if(void 0===j)return"Unknown character "+m;l=o(l)^j,u+6>=d.length||h.push(j)}return 1!==l?"Invalid checksum for "+e:{prefix:n,words:h}}function l(e,t,a,r){for(var s=0,i=0,n=(1<<a)-1,o=[],c=0;c<e.length;++c)for(s=s<<t|e[c],i+=t;i>=a;)i-=a,o.push(s>>i&n);if(r)i>0&&o.push(s<<a-i&n);else{if(i>=t)return"Excess padding";if(s<<a-i&n)return"Non-zero padding"}return o}e.exports={decodeUnsafe:function(){var e=d.apply(null,arguments);if("object"===typeof e)return e},decode:function(e){var t=d.apply(null,arguments);if("object"===typeof t)return t;throw new Error(t)},encode:function(e,t,a){if(a=a||90,e.length+7+t.length>a)throw new TypeError("Exceeds length limit");var s=c(e=e.toLowerCase());if("string"===typeof s)throw new Error(s);for(var i=e+"1",n=0;n<t.length;++n){var d=t[n];if(d>>5!==0)throw new Error("Non 5-bit word");s=o(s)^d,i+=r.charAt(d)}for(n=0;n<6;++n)s=o(s);for(s^=1,n=0;n<6;++n){i+=r.charAt(s>>5*(5-n)&31)}return i},toWordsUnsafe:function(e){var t=l(e,8,5,!0);if(Array.isArray(t))return t},toWords:function(e){var t=l(e,8,5,!0);if(Array.isArray(t))return t;throw new Error(t)},fromWordsUnsafe:function(e){var t=l(e,5,8,!1);if(Array.isArray(t))return t},fromWords:function(e){var t=l(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}}},1137:function(e,t,a){"use strict";a.r(t);var r=a(30),s=a(13),i=a(0),n=a.n(i),o=a(1),c=a.n(o),d=a(55),l=a.n(d),h=a(98),u=a(1117),m=a.n(u),j=a(141),b=a.n(j),f=a(1038),g=a.n(f),v=a(1025),p=a(1061),x=a(15),O=a(138),C=a(71),w=a(1031),S=a(293),k=a(1032),I=a(1139),y=a(1033),D=a(1023),A=a(171),M=a(297);class z extends n.a.Component{constructor(e,t){super(e),this.onSubmit=()=>{var e=this.props,t=e.onClose,a=e.candidateId;this.form.current.validateFields(((e,r)=>{if(!e){var s=r.value;this.contracts.DPoS.methods.delegate.cacheSend(a,b.a.utils.toWei(s.toString(),"ether")),t()}}))},this.form=n.a.createRef(),this.contracts=t.drizzle.contracts}render(){var e=this.props,t=e.visible,a=e.onClose,i=[{name:"value",field:"number",fieldOptions:Object(r.a)(Object(r.a)({},M.a),{},{placeholder:"The amount of CELR to delegate"}),rules:[{message:"Please enter a value!",required:!0}]}];return Object(s.jsx)(D.a,{title:"Delegate Stake",visible:t,onOk:this.onSubmit,onCancel:a,children:Object(s.jsx)(A.a,{ref:this.form,items:i})})}}z.contextTypes={drizzle:c.a.object};var P=z;class W extends n.a.Component{constructor(e,t){super(e),this.onSubmit=()=>{var e=this.props,t=e.onClose,a=e.candidate,r=a.args[0];this.form.current.validateFields(((e,s)=>{if(!e){var i=s.value;"0"===a.value.status?this.contracts.DPoS.methods.withdrawFromUnbondedCandidate.cacheSend(r,b.a.utils.toWei(i.toString(),"ether")):this.contracts.DPoS.methods.intendWithdraw.cacheSend(r,b.a.utils.toWei(i.toString(),"ether")),t()}}))},this.form=n.a.createRef(),this.contracts=t.drizzle.contracts}render(){var e=this.props,t=e.visible,a=e.onClose,i=[{name:"value",field:"number",fieldOptions:Object(r.a)(Object(r.a)({},M.a),{},{placeholder:"The amount of CELR to withdraw"}),rules:[{message:"Please enter a value!",required:!0}]}];return Object(s.jsx)(D.a,{title:"Withdraw Stake",visible:t,onOk:this.onSubmit,onCancel:a,children:Object(s.jsx)(A.a,{ref:this.form,items:i})})}}W.contextTypes={drizzle:c.a.object};var V=W,R=a(224);class N extends n.a.Component{constructor(e,t){super(e),this.handleIncreaseCommission=()=>{var e=this.props,t=e.onClose,a=e.network,r=e.candidate;this.form.current.validateFields(((e,s)=>{if(e)console.log(e);else{var i=s.commissionRate,n=s.rateLockEndTime;i*=R.a,n=l.a.toNumber(n)+a.block.number,i>r.value.commissionRate?this.contracts.DPoS.methods.announceIncreaseCommissionRate.cacheSend(i,n):this.contracts.DPoS.methods.nonIncreaseCommissionRate.cacheSend(i,n),t()}}))},this.state={},this.form=n.a.createRef(),this.contracts=t.drizzle.contracts}render(){var e=this.props,t=e.visible,a=e.onClose,r=[M.b,M.d];return Object(s.jsx)(D.a,{title:"Increase Commission Rate",visible:t,onOk:this.handleIncreaseCommission,onCancel:a,children:Object(s.jsx)(A.a,{ref:this.form,items:r})})}}N.contextTypes={drizzle:c.a.object};var T=Object(h.drizzleConnect)(N,(function(e){return{network:e.network}})),E=a(1135),U=a(296),L=[{title:"Delegator",dataIndex:"delegatorAddr"},{title:"Delegated Stake",dataIndex:"delegatedStake",sorter:(e,t)=>b.a.utils.toBN(e.delegatedStake).cmp(b.a.utils.toBN(t.delegatedStake)),sortOrder:"descend",render:e=>Object(U.a)(e)}];class G extends n.a.Component{constructor(e,t){super(e);var a=e.candidateId,r=e.network.setting;this.state={},g.a.get("".concat(r.gateway,"/validator/candidate-delegators/").concat(a)).then((e=>{var t=e.data.result.map((e=>({candidateAddr:e.candidate_addr,delegatedStake:e.delegated_stake,delegatorAddr:e.delegator_addr})));this.setState({delegators:t})})).catch((e=>{console.error(e),e.response?k.a.error(e.response.data.error):k.a.warning("Please config gateway url in setting to load sidechain info correctly")}))}render(){var e=this.state.delegators;return Object(s.jsx)(O.a,{children:Object(s.jsx)(C.a,{span:24,children:Object(s.jsx)(E.a,{dataSource:e,columns:L,pagination:!1})})})}}G.contextTypes={drizzle:c.a.object};var _=Object(h.drizzleConnect)(G,(function(e){return{network:e.network}})),B=[{title:"Delegator",dataIndex:"delegator"},{title:"Amount",dataIndex:"amount"}];class F extends n.a.Component{render(){var e=this.props.slashes,t=e.sort(((e,t)=>e.validator>t.validator)).map((e=>Object(r.a)(Object(r.a)({},e),{},{amount:Object(U.a)(e.amount)})));return console.log(e),Object(s.jsx)(E.a,{dataSource:t,columns:B,pagination:!1})}}var q=Object(h.drizzleConnect)(F,(function(e){return{}})),J=a(1035);class Y extends n.a.Component{constructor(e,t){super(e),this.toggleDelegateModal=()=>{this.setState((e=>({isDelegateModalVisible:!e.isDelegateModalVisible})))},this.toggleWithdrawModal=()=>{this.setState((e=>({isWithdrawModalVisible:!e.isWithdrawModalVisible})))},this.toggleCommissionModal=()=>{this.setState((e=>({isCommissionModalVisible:!e.isCommissionModalVisible})))},this.confirmWithdraw=()=>{var e=this.state.candidateId;this.contracts.DPoS.methods.confirmWithdraw.cacheSend(e)},this.confirmIncreaseCommissionRate=()=>{this.contracts.DPoS.methods.confirmIncreaseCommissionRate.cacheSend()},this.claimValidator=()=>{this.contracts.DPoS.methods.claimValidator.cacheSend()},this.renderAction=()=>{var e=this.props.accounts,t=this.state.candidate,a=t.value.status,r=e[0]===t.args[0],i=Object(s.jsxs)(v.a,{children:[Object(s.jsx)(v.a.Item,{onClick:this.toggleDelegateModal,children:"Delegate"}),"0"===a?Object(s.jsx)(v.a.Item,{onClick:this.toggleWithdrawModal,children:"Withdraw"}):[Object(s.jsx)(v.a.Item,{onClick:this.toggleWithdrawModal,children:"Initialize Withdraw"}),Object(s.jsx)(v.a.Item,{onClick:this.confirmWithdraw,children:"Confirm Withdraw"})],r&&Object(s.jsx)(v.a.Item,{onClick:this.toggleCommissionModal,children:"Announce Increase Commission Rate"}),r&&Object(s.jsx)(v.a.Item,{onClick:this.confirmIncreaseCommissionRate,children:"Confirm Increase Commission Rate"}),r&&Object(s.jsx)(v.a.Item,{onClick:this.claimValidator,children:"Claim Validator"})]});return Object(s.jsx)(p.a,{overlay:i,children:Object(s.jsxs)("a",{className:"ant-dropdown-link",children:["Actions ",Object(s.jsx)(x.a,{type:"down"})]})})},this.renderCandidateDetail=()=>{var e=this.props.SGN,t=this.state,a=t.candidate,r=t.slashes,i=t.description,n=void 0===i?{}:i,o=a.args[0],c=a.value,d=c.minSelfStake,h=c.stakingPool,u=c.status,j=c.commissionRate,f=c.rateLockEndTime,g=l.a.chain(e.sidechainAddrMap).find((e=>e.args[0]===o)).get("value","").value(),v=g&&m.a.encode("sgn",m.a.toWords(b.a.utils.hexToBytes(g)));return Object(s.jsxs)(O.a,{style:{marginTop:"10px"},children:[Object(s.jsx)(C.a,{span:12,children:Object(s.jsx)(w.a,{title:"Address",value:o})}),Object(s.jsx)(C.a,{span:12,children:Object(s.jsx)(w.a,{title:"Status",value:J.a[u]})}),Object(s.jsx)(C.a,{span:12,children:Object(s.jsx)(w.a,{title:"Min Self Stake",value:Object(U.a)(d)})}),Object(s.jsx)(C.a,{span:12,children:Object(s.jsx)(w.a,{title:"Staking Pool",value:Object(U.a)(h)})}),Object(s.jsx)(C.a,{span:12,children:Object(s.jsx)(w.a,{title:"Commission Rate",value:"".concat(j/R.a," %")})}),Object(s.jsx)(C.a,{span:12,children:Object(s.jsx)(w.a,{title:"Rate Lock End Time",value:"".concat(f," block height")})}),Object(s.jsx)(C.a,{span:12,children:Object(s.jsx)(w.a,{title:"Website",value:n.website||"N/A"})}),Object(s.jsx)(C.a,{span:12,children:Object(s.jsx)(w.a,{title:"Contact",value:n.security_contact||"N/A"})}),Object(s.jsx)(C.a,{span:12,children:Object(s.jsx)(w.a,{title:"Sidechain Address",value:v})}),Object(s.jsx)(C.a,{span:24,children:Object(s.jsxs)(S.a,{children:[Object(s.jsx)(S.a.TabPane,{tab:"Delegators",children:Object(s.jsx)(_,{candidateId:o})},"delegators"),Object(s.jsx)(S.a.TabPane,{tab:"Slashes",children:Object(s.jsx)(q,{slashes:r})},"slashes")]})})]})},this.contracts=t.drizzle.contracts,this.state={candidate:null,slashes:[],isDelegateModalVisible:!1,isWithdrawModalVisible:!1,isCommissionModalVisible:!1};var a=e.match,i=e.network.setting,n=a.params.id;this.contracts.SGN.methods.sidechainAddrMap.cacheCall(n),this.contracts.DPoS.events.Slash({fromBlock:0,filter:{validator:n}},((e,t)=>{e||this.setState({slashes:[...this.state.slashes,t.returnValues]})})),g.a.get("".concat(i.gateway,"/validator/candidate/").concat(n)).then((e=>{var t=e.data.result;this.setState(Object(r.a)(Object(r.a)({},t),{},{commissionRate:t.commission_rate,stakingPool:t.staking_pool}))})).catch((e=>{console.error(e),e.response?k.a.error(e.response.data.error):k.a.warning("Please config gateway url in setting to load sidechain info correctly")}))}static getDerivedStateFromProps(e){var t=e.match,a=e.DPoS,r=void 0===a?{}:a,s=t.params.id,i=l.a.values(r.getCandidateInfo),n=l.a.find(i,(e=>e.args[0]===s)),o=l.a.values(r.getDelegatorInfo).filter((e=>e.args[0]===s));return{candidate:n,candidateId:s,delegators:o}}render(){var e=this.state,t=e.candidate,a=e.candidateId,r=e.isDelegateModalVisible,i=e.isWithdrawModalVisible,n=e.isCommissionModalVisible;return t?Object(s.jsxs)(y.a,{title:"Candidate",extra:this.renderAction(),children:[this.renderCandidateDetail(),Object(s.jsx)(P,{candidateId:a,visible:r,onClose:this.toggleDelegateModal}),Object(s.jsx)(V,{candidate:t,visible:i,onClose:this.toggleWithdrawModal}),Object(s.jsx)(T,{candidate:t,visible:n,onClose:this.toggleCommissionModal})]}):Object(s.jsx)(I.a,{})}}Y.contextTypes={drizzle:c.a.object};t.default=Object(h.drizzleConnect)(Y,(function(e){var t=e.accounts,a=e.contracts,s=e.network,i=e.DPoS,n=e.SGN;return{accounts:t,network:s,DPoS:Object(r.a)(Object(r.a)({},i),a.DPoS),SGN:Object(r.a)(Object(r.a)({},n),a.SGN)}}))}}]);
//# sourceMappingURL=6.57202519.chunk.js.map